package com.bestfunforever.andengine.uikit.entity.text;

import org.andengine.entity.text.Text;
import org.andengine.entity.text.TextOptions;
import org.andengine.entity.text.vbo.ITextVertexBufferObject;
import org.andengine.input.touch.TouchEvent;
import org.andengine.opengl.font.IFont;
import org.andengine.opengl.shader.ShaderProgram;
import org.andengine.opengl.vbo.DrawType;
import org.andengine.opengl.vbo.VertexBufferObjectManager;

import android.util.Log;

import com.bestfunforever.andengine.uikit.entity.IClick;
import com.bestfunforever.andengine.uikit.entity.ISelector;

public class TextExtension extends Text implements ISelector {

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			TextOptions pTextOptions, ITextVertexBufferObject pTextVertexBufferObject, ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pTextOptions, pTextVertexBufferObject, pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			TextOptions pTextOptions, ITextVertexBufferObject pTextVertexBufferObject) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pTextOptions, pTextVertexBufferObject);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			TextOptions pTextOptions, VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType,
			ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pTextOptions, pVertexBufferObjectManager, pDrawType,
				pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			TextOptions pTextOptions, VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pTextOptions, pVertexBufferObjectManager, pDrawType);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			TextOptions pTextOptions, VertexBufferObjectManager pVertexBufferObjectManager) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pTextOptions, pVertexBufferObjectManager);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType, ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pVertexBufferObjectManager, pDrawType, pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pVertexBufferObjectManager, pDrawType);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			VertexBufferObjectManager pVertexBufferObjectManager, ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pVertexBufferObjectManager, pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, int pCharactersMaximum,
			VertexBufferObjectManager pVertexBufferObjectManager) {
		super(pX, pY, pFont, pText, pCharactersMaximum, pVertexBufferObjectManager);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, TextOptions pTextOptions,
			VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType, ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pTextOptions, pVertexBufferObjectManager, pDrawType, pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, TextOptions pTextOptions,
			VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType) {
		super(pX, pY, pFont, pText, pTextOptions, pVertexBufferObjectManager, pDrawType);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, TextOptions pTextOptions,
			VertexBufferObjectManager pVertexBufferObjectManager, ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pTextOptions, pVertexBufferObjectManager, pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText, TextOptions pTextOptions,
			VertexBufferObjectManager pVertexBufferObjectManager) {
		super(pX, pY, pFont, pText, pTextOptions, pVertexBufferObjectManager);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText,
			VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType, ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pVertexBufferObjectManager, pDrawType, pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText,
			VertexBufferObjectManager pVertexBufferObjectManager, DrawType pDrawType) {
		super(pX, pY, pFont, pText, pVertexBufferObjectManager, pDrawType);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText,
			VertexBufferObjectManager pVertexBufferObjectManager, ShaderProgram pShaderProgram) {
		super(pX, pY, pFont, pText, pVertexBufferObjectManager, pShaderProgram);
		// TODO Auto-generated constructor stub
	}

	public TextExtension(float pX, float pY, IFont pFont, CharSequence pText,
			VertexBufferObjectManager pVertexBufferObjectManager) {
		super(pX, pY, pFont, pText, pVertexBufferObjectManager);
		// TODO Auto-generated constructor stub
	}

	public int ID = 0;

	@Override
	public int getId() {
		// TODO Auto-generated method stub
		return ID;
	}

	@Override
	public void setId(int id) {
		// TODO Auto-generated method stub
		this.ID = id;
	}


	public enum State {
		NORMAL, PRESS, SELECTED, NOACTION
	}

	protected State mState = State.NOACTION;

	public State getState() {
		return mState;
	}

	public void setState(State mState) {
		Log.d("", "BubbleSprite setState mState " + mState);
		if (mState != this.mState) {

			switch (mState) {
			case NORMAL:
				onNormalState();
				break;
			case PRESS:
				onPressState();
				break;
			case SELECTED:
				onSelectedState();
				break;
			case NOACTION:

				break;

			default:
				break;
			}
			this.mState = mState;
		}
	}

	private IClick mClickListenner;

	public static final float MINACTIONMOVE = 20;
	protected float startX, startY;
	protected float distanceX, distanceY;
	private boolean isEnabled = true;

	public boolean isEnabled() {
		return isEnabled;
	}

	public void setEnabled(boolean isEnabled) {
		this.isEnabled = isEnabled;
	}

	private boolean isdown = false;

	private float[] touchChecker = new float[2];

	@Override
	public boolean onAreaTouched(TouchEvent pSceneTouchEvent, float pTouchAreaLocalX, float pTouchAreaLocalY) {
		if (!isEnabled) {
			return true;
		}
		final int action = pSceneTouchEvent.getAction();
		Log.d("", "onAreaTouched x " + pSceneTouchEvent.getX() + " y " + pSceneTouchEvent.getY() + "  lcX "
				+ pTouchAreaLocalX + " lcY " + pTouchAreaLocalY);
		switch (action) {
		case TouchEvent.ACTION_DOWN:
			isdown = true;
			startX = pSceneTouchEvent.getX();
			startY = pSceneTouchEvent.getY();
			onPressState();
			break;
		case TouchEvent.ACTION_MOVE:
			touchChecker = convertSceneToLocalCoordinates(pSceneTouchEvent.getX(), pSceneTouchEvent.getY());
			if (checkActionOutSide(touchChecker)) {
				onPressState();
			} else {
				onNormalState();
			}

			break;

		case TouchEvent.ACTION_UP:
			if (isdown) {
				touchChecker = convertSceneToLocalCoordinates(pSceneTouchEvent.getX(), pSceneTouchEvent.getY());
				if (checkActionOutSide(touchChecker)) {
					onSelectedState();
					if (mClickListenner != null) {
						mClickListenner.onCLick(this);
					}
				} else {
					onNormalState();
				}
			}

			break;

		case TouchEvent.ACTION_CANCEL:
			Log.d("", "acttion cancel");
			onNormalState();
			break;

		case TouchEvent.ACTION_OUTSIDE:
			Log.d("", "acttion out side");
			onNormalState();
			break;

		default:
			break;
		}

		return true;
	}

	private boolean checkActionOutSide(float[] touchChecker) {
		if (touchChecker[0] < 0 || touchChecker[0] > getWidth() || touchChecker[1] < 0 || touchChecker[1] > getHeight()) {
			Log.d("", "checkActionOutSide ouside");
			return false;
		}
		Log.d("", "checkActionOutSide inside");
		return true;
	}

	public IClick getClickListenner() {
		return mClickListenner;
	}

	public void setClickListenner(IClick mClickListenner) {
		this.mClickListenner = mClickListenner;
	}

	@Override
	public void onSelectedState() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void onNormalState() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void onPressState() {
		// TODO Auto-generated method stub
		
	}
}
